?select
detach("package::tidyr", unlead = T)
detach("package::tidyr", unload = T)
detach("package:tidyr", unload = T)
load_all()
library(devtools)
load_all()
thunder("tests/testthat/test_data.txt.gz", n_cell_types = 3, itter = 1)
document()
build()
document()
load_all
load_all()
thunder("tests/testthat/test_data.txt.gz", n_cell_types = 3, itter = 1)
document
document()
check()
check()
document()
?thunder
x x<-2
x<-2
x
print("test", x)
print(c("test", x))
proc.time()
t <- proc.time()
proc.time() - t
print(paste0("test: "), proc.time() - t)
t
print(paste0("test: ", proc.time() - t))
proc.time() - t)
proc.time() - t
print(paste0("test: ", proc.time() - t))
library(devtools)
document()
document()
check()
check()
check()
run_thunder("test_data.txt.gz", n_cell_types = 5,
itter = 1)
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
load_all()
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
.subset_mix
source('~/Desktop/UNC/research/yun/HiC/thundeR/R/thunder.R')
thunder_estimate_CTP(.subset_mix,
n_cell_types,
itter)
.subset_mix
load_all()
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
load_all()
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 5,
itter = 1)
check()
check()
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 2,
itter = 1,
out_init_nmf = "test_data_init_out.rds")
test()
test_check()
?test
test(show_report = T)
test_file()
test_file(path = "tests/testthat/test-thunder.R")
test_file(path = "tests/testthat/test-mutate_basis_matrix.R")
test_file(path = "tests/testthat/test-thunder.R")
load_all()
test_file(path = "tests/testthat/test-thunder.R")
test_file(path = "tests/testthat/test-thunder.R")
test_check("thunder")
test_file(path = "tests/testthat/test-thunder.R")
run_thunder("tests/testthat/test_data.txt.gz", n_cell_types = 2,
itter = 1,
out_init_nmf = "test_data_init_out.rds")
check()
check()
test()
check()
document()
load_all()
document()
library(thundeR)
library(devtools)
load_all()
thunder_feature_selection("tests/testthat/test_data.txt.gz", n_cell_types = 2, itter = 1)
?test
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
thunder_feature_selection("tests/testthat/test_data.txt.gz", itter = 1, n_cell_types = 2)
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
thunder_feature_selection("tests/testthat/test_data.txt.gz", itter = 1, n_cell_types = 2)
load_all()
thunder_feature_selection("tests/testthat/test_data.txt.gz", itter = 1, n_cell_types = 2)
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
?tibble::rownames_to_column
load_all()
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
?expect_true
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
thunder_feature_selection("tests/testthat/test_data.txt.gz", itter = 1, n_cell_types = 2)
test(filter = "subset_mixture*")
load_all()
test(filter = "subset_mixture*")
test()
library(NMF)
test()
test()
test(filter = "mutate")
thunder_feature_selection("tests/testthat/test_data.txt.gz", itter = 1, n_cell_types = 2)
test(filter = "mutate")
?digest_function
test(filter = "mutate")
load_all()
test()
run_thunder("test_data.txt.gz", n_cell_types = k,
itter = 1)
setwd("~/Desktop/UNC/research/yun/HiC/thundeR/tests/testthat")
setwd("~/Desktop/UNC/research/yun/HiC/thundeR/tests/testthat")
run_thunder("test_data.txt.gz", n_cell_types = k,
itter = 1)
run_thunder("test_data.txt.gz", n_cell_types = 3,
itter = 1)
write_tsv
subset_mix_out_path
?write_tsv
is.character("NULL")
is.character(NULL)
run_thunder("test_data.txt.gz", n_cell_types = 2,
itter = 1)
thunder_feature_selection("test_data.txt.gz", itter = 1, n_cell_types = 2)
load_all()
run_thunder("test_data.txt.gz", n_cell_types = 2,
itter = 1)
run_thunder("test_data.txt.gz", n_cell_types = 2,
itter = 1)
load_all()
run_thunder("test_data.txt.gz", n_cell_types = 2,
itter = 1)
thunder_feature_selection("test_data.txt.gz", itter = 1, n_cell_types = 2)
t <- thunder_feature_selection("test_data.txt.gz", itter = 1, n_cell_types = 2)
t
load_all()
run_thunder("test_data.txt.gz", n_cell_types = 2,
)
run_thunder("test_data.txt.gz", n_cell_types = 2)
run_thunder("test_data.txt.gz")
run_thunder("test_data.txt.gz", n_cell_types, itter = 1, subset_mix_out_path = "test_subset.txt.gz")
run_thunder("test_data.txt.gz", n_cell_types = 2, itter = 1, subset_mix_out_path = "test_subset.txt.gz")
run_thunder("test_data.txt.gz", n_cell_types = 2, itter = 1, subset_mix_out_path = "test_subset.txt.gz")
mixture
read_tsv("test_subset.txt.gz")
run_thunder("test_data.txt.gz", n_cell_types = 2, itter = 1, subset_mix_out_path = "test_subset.txt.gz")
load_all()
run_thunder("test_data.txt.gz", n_cell_types = 2, itter = 1, subset_mix_out_path = "test_subset.txt.gz")
test()
test()
test()
test()
test()
build()
build()
?run_thunder
library(thundeR)
load_all()
library(devtools)
load_all()
?run_thund
library(tidyverse)
?`name-repair`
?as_tibble
build()
library(devtools)
build()
test()
build()
test()
buid()
build()
?install_github
library(tidyverse)
library(NMF)
read_tsv("tests/testthat/test_data.txt.gz")
nmf(read_tsv("tests/testthat/test_data.txt.gz"), rank = 2,
nrun = 1)
read_tsv("tests/testthat/test_data.txt.gz")
mix <- read_tsv("tests/testthat/test_data.txt.gz") %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
mix
nmf(mix, rank = 2,
nrun = 1)
fit <- nmf(mix, rank = 2, nrun = 1)
library(devtools)
build()
mutate_basis_matrix(fit)
mix <- read_tsv("tests/testthat/test_data.txt.gz") %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
fit <- nmf(mix, rank = 2, nrun = 1)
?mutate_basis_natrix
library(thundeR)
build()
load_all()
mutate_basis_matrix(fit)
mutate_basis_matrix(fit) %>%
count(contact_type)
read_tsv("tests/testthat/test_data.txt.gz")
read_tsv("tests/testthat/test_data.txt.gz")
mix <- read_tsv("tests/testthat/test_data.txt.gz") %>%
mutate(bin_name = sample(c("human_chr1_1_human_chr1_2",
"human_chr1_1_human_chr_2_2"), 99)) %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
read_tsv("tests/testthat/test_data.txt.gz") %>%
mutate(bin_name = sample(c("human_chr1_1_human_chr1_2",
"human_chr1_1_human_chr_2_2"), 99))
read_tsv("tests/testthat/test_data.txt.gz") %>%
mutate(bin_name = sample(c("human_chr1_1_human_chr1_2",
"human_chr1_1_human_chr_2_2"), 99,
replace = T))
set.seed(13)
mix <- read_tsv("tests/testthat/test_data.txt.gz") %>%
mutate(bin_name = sample(c("human_chr1_1_human_chr1_2",
"human_chr1_1_human_chr_2_2"), 99,
replace = T)) %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
mix <- read_tsv("tests/testthat/test_inter_intra.txt.gz") %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
fit <- nmf(mix, rank = 2, nrun = 1)
mutate_basis_matrix(fit) %>%
count(contact_type)
b <- mutate_basis_matrix(fit)
b %>%
group_by(contact_type) %>%
summarise(thunder_bins = list(which(
(.$feature_score > mean(.$feature_score) + 3*sd(.$feature_score)) |
(.$std_dev > mean(.$std_dev) + 3*sd(.$std_dev))
)))
b
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
summarise(thunder_bins = list(which(
(.$feature_score > mean(.$feature_score) + 3*sd(.$feature_score)) |
(.$std_dev > mean(.$std_dev) + 3*sd(.$std_dev))
)))
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score))
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score))
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev))
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev))
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
set.seed(13)
mix <- read_tsv("tests/testthat/test_inter_intra.txt.gz") %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
fit <- nmf(mix, rank = 2, nrun = 1)
b <- mutate_basis_matrix(fit)
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
set.seed(13)
mix <- read_tsv("tests/testthat/test_inter_intra.txt.gz") %>%
column_to_rownames("bin_name") %>%
filter(rowSums(.) != 0)
fit <- nmf(mix, rank = 2, nrun = 1)
b <- mutate_basis_matrix(fit)
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
group_by(contact_type) %>%
summarise(thunder_bins = list(which(
(.$feature_score > mean(.$feature_score) + 3*sd(.$feature_score)) |
(.$std_dev > mean(.$std_dev) + 3*sd(.$std_dev))
))) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
rows <- b %>%
group_by(contact_type) %>%
summarise(thunder_bins = list(which(
(.$feature_score > mean(.$feature_score) + 3*sd(.$feature_score)) |
(.$std_dev > mean(.$std_dev) + 3*sd(.$std_dev))
))) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
head(mix[rows,])
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
b %>%
mutate(index = row_number()) %>%
# group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
b %>%
mutate(index = row_number()) %>%
group_by(contact_type) %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
filter(contact_type ==  "intra") %>%
filter(contact_type ==  "intra") %>%
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index))
?mad
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
bind_rows(
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)),
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
)
bind_rows(
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)),
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
bind_rows(
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)),
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
) %>%
tidyr::unnest(thunder_bins)
bind_rows(
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "inter") %>%
filter(feature_score > mean(feature_score) + 3*sd(feature_score) |
std_dev > mean(std_dev) + 3 * sd(std_dev)) %>%
summarize(thunder_bins = list(index)),
b %>%
mutate(index = row_number()) %>%
filter(contact_type ==  "intra") %>%
filter(feature_score > median(feature_score) + 3*mad(feature_score)) %>%
summarize(thunder_bins = list(index))
) %>%
tidyr::unnest(thunder_bins) %>%
ungroup() %>%
arrange(thunder_bins) %>%
pull(thunder_bins)
?bind_rows
?filter
build()
load_all()
library(devtools)
build()
load_all()
test()
test()
?mad
